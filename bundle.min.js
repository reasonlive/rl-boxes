!function(){"use strict";class e{constructor(e){this.elem=e,this.width=e.offsetWidth,this.height=e.offsetHeight}shift(e){let{top:n,right:i,bottom:o,left:s}=this.elem.parentNode.getBoundingClientRect();if("right"===e&&this.elem.getBoundingClientRect().right!==i){let{x:e,y:n}=this.elem.getBoundingClientRect();document.elementFromPoint(e+100,n)===this.elem.parentNode&&(this.elem.style.marginLeft=t(this.elem.style.marginLeft,this.width,"+"))}if("down"===e&&this.elem.getBoundingClientRect().bottom!==o){let{x:e,y:n}=this.elem.getBoundingClientRect();document.elementFromPoint(e,n+100)===this.elem.parentNode&&(this.elem.style.marginTop=t(this.elem.style.marginTop,this.height,"+"))}if("left"===e&&this.elem.getBoundingClientRect().left!==s){let{x:e,y:n}=this.elem.getBoundingClientRect();document.elementFromPoint(e-100,n)===this.elem.parentNode&&(this.elem.style.marginLeft=t(this.elem.style.marginLeft,this.width,"-"))}if("up"===e&&this.elem.getBoundingClientRect().top!==n){let{x:e,y:n}=this.elem.getBoundingClientRect();document.elementFromPoint(e,n-100)===this.elem.parentNode&&(this.elem.style.marginTop=t(this.elem.style.marginTop,this.height,"-"))}}switchFocus(e){}setEvents(){this.elem.addEventListener("focus",(function(e){this.classList.add("active")})),this.elem.addEventListener("blur",(function(e){this.classList.remove("active")})),this.elem.addEventListener("keydown",e=>{if(document.activeElement===e.target)switch(e.keyCode){case 37:this.shift("left");break;case 38:this.shift("up");break;case 39:this.shift("right");break;case 40:this.shift("down");break;default:return}}),this.elem.addEventListener("mouseover",(function(e){this.focus()}))}getCoords(){return this.elem.getBoundingClientRect()}}function t(e,t,n){let i="";return e||(e=0),(isNaN(e)||"string"==typeof e)&&(e=parseInt(e)),"+"===n&&(i=e+t),"-"===n&&(i=e-t),i+"px"}function n(e){var t={};e=e||{};function n(e){for(let n in e)t[n]=e[n]}function i(e,n){t[e]=n}function o(e){return t[e]}function s(e){let t=document.elementFromPoint(e.pageX,e.pageY);t&&!t.classList.contains("draggable")&&(t.classList.remove("enable"),r(e))}function l(t){let[n,i]=t,o=n.type?n.type:i.type;for(let n in e)e[o]&&e[o](t)}function a(...e){let[t]=e,o=t.pageX,s=t.pageY,a=t.target;a.classList.contains("draggable")&&(i("oldElementState",function(e){return{position:e.style.position,zIndex:e.style.zIndex,left:e.style.left,top:e.style.top}}(a)),a.classList.add("enable"),a.style.position="absolute",a.style.zIndex=1e3,n({shiftFromLeftSide:o-a.getBoundingClientRect().left,shiftFromTopSide:s-a.getBoundingClientRect().top,startx:o,starty:s,shiftFromRightSide:a.getBoundingClientRect().right-o,shiftFromBottomSide:a.getBoundingClientRect().bottom-s}),l(e),document.addEventListener("mouseup",(function(e){r(t)})))}function r(...e){document.getElementsByClassName("enable")[0]&&document.getElementsByClassName("enable")[0].classList.remove("enable");let n=o("object");t={},i("object",n)}this.getOptions=function(){if(t)return t},this.apply=function(e){if(e instanceof HTMLElement)t.object=[e],t.object[0].classList.add("draggable");else{if(!(e instanceof HTMLCollection))throw new Error("argument must be DOM Entity");t.object=e;for(let n=0;n<e.length;n++)t.object[n].classList.add("draggable")}},this.setDropZone=function(e){this._droppable||(this._droppable={}),this._droppable.object=e},this.getDropZone=()=>{if(this._droppable)return this._droppable},this.setDropZoneProperty=(e,t)=>{if(!this._droppable)return new Error("you haven't droppable object");this._droppable[e]=t},this.addProperties=n,this.moveOnlyLeftToRight=function(...e){let[t]=e;t.target.style.left=t.pageX-o("shiftFromLeftSide")+"px",s(t),l(e)},this.moveOnlyTopToBottom=function(...e){let[t]=e;t.target.style.top=t.pageY-o("shiftFromTopSide")+"px",s(t),l(e)},this.dropElement=r,this.initEvents=function(e){if(!o("object"))return;document.ondragstart=function(e){return e.preventDefault(),!1};let t=o("object");for(let n=0;n<t.length;n++)t[n].addEventListener("mousedown",t=>{e&&e[t.type]?e[t.type](t):a(t)}),t[n].addEventListener("mouseup",t=>{e&&e[t.type]?e[t.type](t):r()});document.addEventListener("mousemove",(function(t){e&&e[t.type]?e[t.type](t):function(...e){let[t]=e,n=t.target;n.style.left=t.pageX-o("shiftFromLeftSide")+"px",n.style.top=t.pageY-o("shiftFromTopSide")+"px",l(e)}(t)}))}}class i{constructor(e){return this.state=e,this}tick(){this.value.s<59?this.value.s+=1:(this.value.s=0,this.value.m+=1),this.value.m>59&&(this.value.m=0,this.value.h+=1),this.value.h>23&&(this.value.h=this.value.m=this.value.s=0)}reversedTick(){0===this.value.s&&(this.value.s=60),this.value.s<61&&this.value.s>1?this.value.s-=1:(this.value.s=0,this.value.m-=1),this.value.m<0&&(this.value.m=59,this.value.h-=1),this.value.h<0&&(this.value.h=23,this.value.m=59,this.value.s=0)}now(){let e={hours:(new Date).getHours(),minutes:(new Date).getMinutes(),seconds:(new Date).getSeconds()};return{h:e.hours,m:e.minutes,s:e.seconds}}set(e,t,n){return arguments.length>0?{h:e,m:t,s:n}:{h:0,m:0,s:0}}setReverse(e,t,n){if(!(arguments.length<3))return this.value={h:e,m:t,s:n},this.reversed=!0,this}init(e){return"zero"===this.state&&(this.value=this.set()),"now"===this.state&&(this.value=this.now()),"own"===this.state&&(this.value=e),this}start(e,t){return this.go=setInterval(()=>{this.reversed?(this.reversedTick(),this.render(e)):this.tick(),this.render(e)},t),this}stop(e){return clearInterval(this.go),this.value={h:0,m:0,s:0},this.render(e),this}render(e){let t="";t=this.value.h<10?`0${this.value.h}:`:this.value.h+":",this.value.m<10?t+=`0${this.value.m}:`:t+=this.value.m+":",this.value.s<10?t+="0"+this.value.s:t+=""+this.value.s,e.innerHTML=t}}function o(e){let t=setInterval(()=>{for(let t=0;t<e.length;t++)t%2==0?(n=e[t],i=2,n.style.left=parseInt(n.style.left)-i+"px"):s(e[t],2);var n,i;e[1].getBoundingClientRect().right<0&&clearInterval(t)},20);for(let t=0;t<e.length;t++)t%2==0?e[t].classList.add("box-spread-left"):e[t].classList.add("box-spread-right");!function(e,t){let n="";setTimeout(()=>clearInterval(e),9e3),n=document.createElement("div"),n.className="game-over",n.innerHTML="Game Over",t.append(n),setTimeout(()=>{n.style.fontSize="50px",n.style.cursor="pointer",n.addEventListener("click",()=>window.location.reload())},4e3),requestAnimationFrame((function(e){t.style.background="black"}))}(t,e[1].parentNode)}function s(e,t){e.style.left=parseInt(e.style.left)+t+"px"}function l(e){let t=e.parentNode,{left:n,right:i,bottom:o,top:s}=e.getBoundingClientRect(),l=[];return document.elementFromPoint(n-50,s)===t&&l.push("left"),document.elementFromPoint(i,s)===t&&l.push("right"),document.elementFromPoint(n,s-50)===t&&l.push("top"),document.elementFromPoint(n,o)===t&&l.push("bottom"),l}function a(e,t){let n=e.offsetWidth,i=e.offsetHeight,o=e.getBoundingClientRect().left,s=e.getBoundingClientRect().top,l=e.parentNode,a=null;if("left"===t){for(;l===e.parentNode;)l=document.elementFromPoint(o-n/2,s+i/2),o-=n;l&&l.classList.contains("draggable")&&(a=l)}if("right"===t){for(;l===e.parentNode;)l=document.elementFromPoint(o+n+n/2,s+i/2),o+=n;l&&l.classList.contains("draggable")&&(a=l)}if("top"===t){for(;l===e.parentNode;)l=document.elementFromPoint(o+n/2,s-i/2),s-=i;l&&l.classList.contains("draggable")&&(a=l)}if("bottom"===t){for(;l===e.parentNode;)l=document.elementFromPoint(o+n/2,s+i+i/2),s+=i;l&&l.classList.contains("draggable")&&(a=l)}return a}const r=document.getElementsByClassName("play-box__square"),u=document.getElementsByClassName("player")[0];let m=null;const d=getComputedStyle(r[1]).backgroundColor;let c=!1;function g(){let e=document.createElement("div");e.className="rule-box",e.style.position="absolute",e.style.top="100px",e.style.left="30px",e.innerHTML='<div class=\'rule\'>1.You have to reach the hole in 30 seconds</div>\n\t<br><br><br><div class="rule">2.To start the game click the "start" button</div>',document.body.append(e),document.querySelector(".button").style.display="flex"}function h(){document.getElementsByClassName("button")[0]&&document.getElementsByClassName("button")[0].remove(),document.getElementsByClassName("rule-box")[0]&&document.getElementsByClassName("rule-box")[0].remove()}document.body.onselectstart=function(e){return e.preventDefault(),!1};let p=new class{constructor(e){this.conditions=e||new Map,this.sounds={}}getExtension(e){return e.slice(e.length-3)}getName(e){return e.slice(e.lastIndexOf("/")+1,e.length-4)}setSound(e){this.sounds[this.getName(e)]=new Audio(e)}setSounds(e){for(let t of e)this.sounds[this.getName(t)]=new Audio(t)}getSound(e){return this.sounds[e]}play(e,t){return this.conditions.size>0&&this.conditions.has(e)?this.conditions.get(e)(e):this.getSound(e)&&(t&&(this.getSound(e).volume=t),this.getSound(e).play()),this.getSound(e)}initEvents(){}};p.setSounds(["./audio/btn-begin.mp3","./audio/light.wav","./audio/explode.wav","./audio/over.mp3","./audio/start.mp3","./audio/shift.mp3","./audio/bye.mp3","./audio/applause.mp3","./audio/tick-sound.mp3"]),document.getElementsByClassName("greeting__btn-begin")[0].addEventListener("click",()=>{p.play("btn-begin"),document.getElementsByClassName("greeting")[0].hidden=!0,document.getElementsByClassName("popup")[0].hidden=!1,setTimeout(()=>{document.querySelector(".popup__inset").style.width="300px",document.querySelector(".popup__inset").style.height="100px",setTimeout(()=>{document.querySelector(".popup__inset__content").style.display="block"},400)},400)}),document.querySelector(".input-name").onkeydown=function(e){13===e.keyCode&&this.value&&(u.name=this.value,document.querySelector(".status__text").innerHTML=`\n\t\t"${this.value}" is in the game!`,document.querySelector(".popup").hidden=!0,document.querySelector(".main__play-box").style.display="flex",p.play("start",.1),setTimeout(()=>document.querySelector(".main__play-box").style.opacity=1,0),setTimeout(()=>g(),1e3))},document.querySelector("label[for='name']").addEventListener("click",()=>{let e=document.querySelector(".input-name");e.value&&(u.name=e.value,document.querySelector(".status__text").innerHTML=`\n\t\t"${e.value}" is in the game!`,document.querySelector(".popup").hidden=!0,document.querySelector(".main__play-box").style.display="flex",p.play("start",.1),setTimeout(()=>g(),1e3),setTimeout(()=>document.querySelector(".main__play-box").style.opacity=1,0))}),document.querySelectorAll(".button__item")[1].onclick=function(){p.play("bye",.1),setTimeout(()=>location.reload(),700)},document.querySelector(".button__item").onclick=function(t){p.play("btn-begin"),function(t){let n=function(e){let t=[];for(let n=0;n<e.length;n++){let{left:i,top:o}=e[n].getBoundingClientRect(),s={left:i,top:o};t.push(s)}return t}(t);for(let i=0;i<t.length;i++){t[i].style.position="absolute",t[i].style.left=n[i].left+"px",t[i].style.top=n[i].top+"px",new e(t[i]).setEvents()}}(r);let s=new n;s.apply(r);let g=document.getElementsByClassName("main__play-box")[0],f={left:g.getBoundingClientRect().right-50,top:g.getBoundingClientRect().bottom-50},y={x:f.left,y:f.top};m=y,s.setDropZone(y),s.initEvents({mousedown:function(e){!function(...e){let[t,n]=e,i=t.pageX,o=t.pageY,s=t.target;s.classList.contains("draggable")&&(s.classList.add("enable"),s.style.position="absolute",s.style.zIndex=1e3,s.shiftx=i-s.getBoundingClientRect().left,s.shifty=o-s.getBoundingClientRect().top,s.leftx=s.getBoundingClientRect().left,s.rightx=s.getBoundingClientRect().right,s.topy=s.getBoundingClientRect().top,s.bottomy=s.getBoundingClientRect().bottom,s.leftelem=a(s,"left"),s.rightelem=a(s,"right"),s.topelem=a(s,"top"),s.bottomelem=a(s,"bottom"),n.addProperties({shiftFromLeftSide:i-s.getBoundingClientRect().left,shiftFromTopSide:o-s.getBoundingClientRect().top,startx:i,starty:o,shiftFromRightSide:s.getBoundingClientRect().right-i,shiftFromBottomSide:s.getBoundingClientRect().bottom-o}),document.addEventListener("mousedown",(function(e){})))}(e,s),s.activeElement=e.target,document.getElementsByClassName("enable")[0].style.backgroundColor="darkred"},mousemove:function(e){document.addEventListener("mouseup",e=>{if(s.activeElement&&(p.play("shift"),s.activeElement.style.backgroundColor=d),s.getDropZone()&&s.activeElement===u&&e.pageX>y.x-50&&e.pageX<y.x+50&&e.pageY>y.y-50&&e.pageY<y.y+50){let[e,t]=[u.getBoundingClientRect().left,u.getBoundingClientRect().top];e==y.x-50&&e<y.x+50&&t==y.y-50&&t<y.y+50&&(c=!0)}delete s.activeElement,s.dropElement(e)}),function(...e){let[t,n,i]=e;if(n.classList.contains("enable")){let e=n.leftelem,o=n.rightelem,s=i.getOptions().shiftFromRightSide,{left:a,right:r}=n.parentNode.getBoundingClientRect();if(!(l(n).length>0))return;if(l(n).some(e=>"left"===e)&&l(n).some(e=>"right"===e)){let i=e?e.getBoundingClientRect().right:a,l=o?o.getBoundingClientRect().left:r;if(!(i<=t.pageX-n.shiftx&&l>=t.pageX+s))return;n.style.left=t.pageX-n.shiftx+"px"}else if(l(n).some(e=>"right"===e)){let i=e?e.getBoundingClientRect().right:a,l=o?o.getBoundingClientRect().left:r;if(!(i<=t.pageX-n.shiftx&&l>=t.pageX+s))return;n.style.left=t.pageX-n.shiftx+"px"}else if(l(n).some(e=>"left"===e)){let i=e?e.getBoundingClientRect().right:a,l=o?o.getBoundingClientRect().left:r;if(!(i<=t.pageX-n.shiftx&&l>=t.pageX+s))return;n.style.left=t.pageX-n.shiftx+"px"}}}(e,e.target,s),function(...e){let[t,n,i]=e;if(n.classList.contains("enable")){let e=n.topelem,o=n.bottomelem,s=i.getOptions().shiftFromBottomSide,{top:a,bottom:r}=n.parentNode.getBoundingClientRect();if(!(l(n).length>0))return;if(l(n).some(e=>"top"===e)&&l(n).some(e=>"bottom"===e)){let i=e?e.getBoundingClientRect().bottom:a,l=o?o.getBoundingClientRect().top:r;if(!(i<=t.pageY-n.shifty&&l>=t.pageY+s))return;n.style.top=t.pageY-n.shifty+"px"}else if(l(n).some(e=>"top"===e)){let i=e?e.getBoundingClientRect().bottom:a,l=o?o.getBoundingClientRect().top:r;if(!(i<=t.pageY-n.shifty&&l>=t.pageY+s))return;n.style.top=t.pageY-n.shifty+"px"}else if(l(n).some(e=>"bottom"===e)){let i=e?e.getBoundingClientRect().bottom:a,l=o?o.getBoundingClientRect().top:r;if(!(i<=t.pageY-n.shifty&&l>=t.pageY+s))return;n.style.top=t.pageY-n.shifty+"px"}}}(e,e.target,s)}}),async function(){m.x=m.x-50,m.y=m.y-50,console.log(m),document.querySelector(".button__item").onclick=null;let e=document.getElementsByClassName("timer")[0];e.hidden=!1;let t=(new i).setReverse(0,29,0).start(e,16),n=p.play("tick-sound",.03);function s(){t.stop(e),p.play("applause"),e.remove(),h(),function(){u.parentNode.remove();let e="<div class='win'>"+u.name+" you are the winner!</div>";document.getElementsByClassName("main")[0].innerHTML=e,document.getElementsByClassName("status__text")[0].innerHTML=e}(),t=p=null}let l=setInterval(()=>{let i=u.getBoundingClientRect().left,o=u.getBoundingClientRect().top;if(c||i==m.x&&o==m.y)return n.muted=!0,t.stop(e),clearInterval(l),void s()},200);await new Promise((t,n)=>setTimeout(()=>t(e.classList.add("timer-blink")),14e3)),await new Promise(n=>setTimeout(()=>{t&&t.stop(e),n(t)},14800)),await new Promise(t=>{p.play("explode",1),e.remove(),h(),t(o(r))}),await new Promise(e=>setTimeout(()=>e(p.play("over")),4e3))}().catch(e=>{console.log(e)})}}();
